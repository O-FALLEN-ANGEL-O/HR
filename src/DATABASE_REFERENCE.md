# HR+ Application Database Schema Reference

This document provides a comprehensive overview of the database schema required for the HR+ application. It is generated by analyzing the application's source code, including type definitions, server actions, and component queries.

## Table of Contents
1.  [Custom Types (ENUMs)](#custom-types)
2.  [Tables](#tables)
    - [users](#1-users)
    - [jobs](#2-jobs)
    - [colleges](#3-colleges)
    - [applicants](#4-applicants)
    - [applicant_notes](#5-applicant_notes)
    - [interviews](#6-interviews)
    - [leave_balances](#7-leave_balances)
    - [leaves](#8-leaves)
    - [onboarding_workflows](#9-onboarding_workflows)
    - [performance_reviews](#10-performance_reviews)
    - [objectives](#11-objectives)
    - [key_results](#12-key_results)
    - [company_posts](#13-company_posts)
    - [post_comments](#14-post_comments)
    - [kudos](#15-kudos)
    - [weekly_awards](#16-weekly_awards)
    - [payslips](#17-payslips)
    - [company_documents](#18-company_documents)
    - [expense_reports](#19-expense_reports)
    - [expense_items](#20-expense_items)
    - [helpdesk_tickets](#21-helpdesk_tickets)
    - [ticket_comments](#22-ticket_comments)

---

## Custom Types

### `user_role` (ENUM)
Defines the different roles a user can have within the system.
- `admin`
- `super_hr`
- `hr_manager`
- `recruiter`
- `interviewer`
- `manager`
- `team_lead`
- `employee`
- `intern`
- `guest`
- `finance`
- `it_admin`
- `support`
- `auditor`

### `applicant_stage` (ENUM)
Defines the stages of the applicant pipeline.
- `Sourced`
- `Applied`
- `Phone Screen`
- `Interview`
- `Offer`
- `Hired`
- `Rejected`

---

## Tables

### 1. `users`
Stores public profile information for all users, synced from `auth.users`.

| Column                  | Type                      | Description                                         |
| ----------------------- | ------------------------- | --------------------------------------------------- |
| `id`                    | `uuid` (Primary Key)      | References `auth.users.id`.                         |
| `full_name`             | `text`                    | User's full name.                                   |
| `email`                 | `text`                    | User's email address.                               |
| `avatar_url`            | `text`                    | URL for the user's profile picture.                 |
| `role`                  | `user_role` (Default: `guest`) | User's role in the system.                       |
| `department`            | `text`                    | The department the user belongs to.                 |
| `phone`                 | `text`                    | User's phone number.                                |
| `profile_setup_complete`| `boolean` (Default: `false`) | Flag for first-time login setup.                 |
| `created_at`            | `timestamptz`             | Timestamp of user creation.                         |

### 2. `jobs`
Stores job postings created by the HR/recruiter team.

| Column        | Type                 | Description                               |
| ------------- | -------------------- | ----------------------------------------- |
| `id`          | `uuid` (Primary Key) | Unique identifier for the job.            |
| `title`       | `text`               | The title of the job position.            |
| `department`  | `text`               | The department the job belongs to.        |
| `description` | `text`               | A detailed description of the job.        |
| `status`      | `text`               | `Open`, `Closed`, or `On hold`.           |
| `posted_date` | `timestamptz`        | The date the job was posted.              |
| `applicants`  | `integer`            | A cached count of applicants.             |

### 3. `colleges`
Stores information about colleges for campus recruitment drives.

| Column             | Type                 | Description                               |
| ------------------ | -------------------- | ----------------------------------------- |
| `id`               | `uuid` (Primary Key) | Unique identifier for the college.        |
| `name`             | `text`               | Name of the college/university.           |
| `status`           | `text`               | `Invited`, `Confirmed`, `Attended`, `Declined`. |
| `resumes_received` | `integer`            | Count of resumes received from the drive. |
| `contact_email`    | `text`               | Email of the college's contact person.    |
| `last_contacted`   | `timestamptz`        | The date the college was last contacted.  |

### 4. `applicants`
Stores information about job applicants.

| Column                   | Type                 | Description                                       |
| ------------------------ | -------------------- | ------------------------------------------------- |
| `id`                     | `uuid` (Primary Key) | Unique identifier for the applicant.              |
| `application_id`         | `serial` (Unique)    | A simple, user-facing sequential ID.              |
| `name`                   | `text`               | Applicant's full name.                            |
| `email`                  | `text`               | Applicant's email.                                |
| `phone`                  | `text`               | Applicant's phone number.                         |
| `job_id`                 | `uuid`               | Foreign key to `jobs.id`.                         |
| `college_id`             | `uuid`               | Foreign key to `colleges.id`.                     |
| `stage`                  | `applicant_stage`    | Current stage in the hiring process.              |
| `applied_date`           | `timestamptz`        | Date of application.                              |
| `avatar`                 | `text`               | URL for the applicant's photo.                    |
| `source`                 | `text`               | Source of application (`walk-in`, `college`, etc).|
| `resume_data`            | `jsonb`              | AI-parsed data from the resume.                   |
| `ai_match_score`         | `integer`            | AI-generated score of match to job description.   |
| `ai_justification`       | `text`               | AI-generated reason for the match score.          |
| `wpm`                    | `integer`            | Words per minute from typing test.                |
| `accuracy`               | `integer`            | Accuracy percentage from typing test.             |
| `aptitude_score`         | `integer`            | Score from the aptitude test.                     |
| `comprehensive_score`    | `integer`            | Score from the comprehensive test.                |
| `english_grammar_score`  | `integer`            | Score from the grammar test.                      |
| `customer_service_score` | `integer`            | Score from the customer service test.             |

### 5. `applicant_notes`
Stores internal notes for an applicant.

| Column          | Type                 | Description                               |
| --------------- | -------------------- | ----------------------------------------- |
| `id`            | `uuid` (Primary Key) | Unique identifier for the note.           |
| `applicant_id`  | `uuid`               | Foreign key to `applicants.id`.           |
| `user_id`       | `uuid`               | Foreign key to `users.id` (author).       |
| `author_name`   | `text`               | Cached name of the author.                |
| `author_avatar` | `text`               | Cached avatar of the author.              |
| `note`          | `text`               | The content of the note.                  |
| `created_at`    | `timestamptz`        | Timestamp of note creation.               |

### 6. `interviews`
Stores scheduled interviews for applicants.

| Column             | Type                 | Description                             |
| ------------------ | -------------------- | --------------------------------------- |
| `id`               | `uuid` (Primary Key) | Unique identifier for the interview.    |
| `applicant_id`     | `uuid`               | Foreign key to `applicants.id`.         |
| `interviewer_id`   | `uuid`               | Foreign key to `users.id`.              |
| `date`             | `date`               | Date of the interview.                  |
| `time`             | `time`               | Time of the interview.                  |
| `type`             | `text`               | `Video`, `Phone`, or `In-person`.       |
| `status`           | `text`               | `Scheduled`, `Completed`, `Canceled`.   |
| `candidate_name`   | `text`               | Cached name of the candidate.           |
| `interviewer_name` | `text`               | Cached name of the interviewer.         |
| `job_title`        | `text`               | Cached title of the job applied for.    |

### 7. `leave_balances`
Tracks available leave days for each user.

| Column         | Type                 | Description                          |
| -------------- | -------------------- | ------------------------------------ |
| `id`           | `uuid` (Primary Key) | Unique identifier.                   |
| `user_id`      | `uuid`               | Foreign key to `users.id`.           |
| `sick_leave`   | `integer`            | Number of sick leave days remaining. |
| `casual_leave` | `integer`            | Number of casual leave days remaining. |
| `earned_leave` | `integer`            | Number of earned leave days remaining. |
| `unpaid_leave` | `integer`            | Number of unpaid leave days taken.   |

### 8. `leaves`
Stores all leave requests made by users.

| Column      | Type                 | Description                                    |
| ----------- | -------------------- | ---------------------------------------------- |
| `id`        | `uuid` (Primary Key) | Unique identifier for the leave request.       |
| `user_id`   | `uuid`               | Foreign key to `users.id`.                     |
| `leave_type`| `text`               | `sick`, `casual`, `earned`, `unpaid`.          |
| `start_date`| `date`               | The first day of leave.                        |
| `end_date`  | `date`               | The last day of leave.                         |
| `reason`    | `text`               | Reason for the leave request.                  |
| `status`    | `text`               | `pending`, `approved`, `rejected`.             |
| `approver_id`| `uuid`              | Foreign key to `users.id` of the approver.     |
| `total_days`| `integer`            | The total number of days for the leave.        |
| `created_at`| `timestamptz`        | Timestamp of leave request creation.           |

### 9. `onboarding_workflows`
Tracks onboarding progress for new hires.

| Column          | Type                 | Description                                  |
| --------------- | -------------------- | -------------------------------------------- |
| `id`            | `uuid` (Primary Key) | Unique identifier for the workflow.          |
| `user_id`       | `uuid`               | Foreign key to `users.id` (new hire).        |
| `manager_id`    | `uuid`               | Foreign key to `users.id` (manager).         |
| `buddy_id`      | `uuid`               | Foreign key to `users.id` (buddy).           |
| `employee_name` | `text`               | Cached name of the new hire.                 |
| `job_title`     | `text`               | Cached job title of the new hire.            |
| `manager_name`  | `text`               | Cached name of the manager.                  |
| `buddy_name`    | `text`               | Cached name of the buddy.                    |
| `progress`      | `integer`            | Onboarding progress percentage.              |
| `current_step`  | `text`               | Current task in the onboarding process.      |
| `start_date`    | `date`               | Start date of the onboarding process.        |

### 10. `performance_reviews`
Stores records of employee performance reviews.

| Column        | Type                 | Description                                  |
| ------------- | -------------------- | -------------------------------------------- |
| `id`          | `uuid` (Primary Key) | Unique identifier for the review.            |
| `user_id`     | `uuid`               | Foreign key to `users.id`.                   |
| `review_date` | `date`               | The date of the review.                      |
| `status`      | `text`               | `Pending`, `In Progress`, `Completed`.       |
| `job_title`   | `text`               | Cached job title at the time of review.      |

### 11. `objectives`
Stores company-wide or individual objectives (OKRs).

| Column    | Type                 | Description                            |
| --------- | -------------------- | -------------------------------------- |
| `id`      | `uuid` (Primary Key) | Unique identifier for the objective.   |
| `owner_id`| `uuid`               | Foreign key to `users.id`.             |
| `title`   | `text`               | The title of the objective.            |
| `quarter` | `text`               | The quarter for the objective (e.g., Q3 2024). |

### 12. `key_results`
Stores key results associated with an objective.

| Column         | Type                 | Description                                |
| -------------- | -------------------- | ------------------------------------------ |
| `id`           | `uuid` (Primary Key) | Unique identifier for the key result.      |
| `objective_id` | `uuid`               | Foreign key to `objectives.id`.            |
| `description`  | `text`               | A description of the key result.           |
| `progress`     | `integer`            | Progress percentage (0-100).               |
| `status`       | `text`               | `on_track`, `at_risk`, `off_track`.        |

### 13. `company_posts`
Stores posts for the company-wide social feed.

| Column       | Type                 | Description                                  |
| ------------ | -------------------- | -------------------------------------------- |
| `id`         | `uuid` (Primary Key) | Unique identifier for the post.              |
| `user_id`    | `uuid`               | Foreign key to `users.id` (author).          |
| `content`    | `text`               | The text content of the post.                |
| `image_url`  | `text`               | Optional URL for an image in the post.       |
| `created_at` | `timestamptz`        | Timestamp of post creation.                  |

### 14. `post_comments`
Stores comments on company feed posts.

| Column       | Type                 | Description                               |
| ------------ | -------------------- | ----------------------------------------- |
| `id`         | `uuid` (Primary Key) | Unique identifier for the comment.        |
| `post_id`    | `uuid`               | Foreign key to `company_posts.id`.        |
| `user_id`    | `uuid`               | Foreign key to `users.id` (author).       |
| `comment`    | `text`               | The content of the comment.               |
| `created_at` | `timestamptz`        | Timestamp of comment creation.            |

### 15. `kudos`
Stores records of recognition given between employees.

| Column         | Type                 | Description                                 |
| -------------- | -------------------- | ------------------------------------------- |
| `id`           | `uuid` (Primary Key) | Unique identifier for the kudo.             |
| `from_user_id` | `uuid`               | Foreign key to `users.id` (giver).          |
| `to_user_id`   | `uuid`               | Foreign key to `users.id` (receiver).       |
| `value`        | `text`               | The company value being recognized.         |
| `message`      | `text`               | The recognition message.                    |
| `created_at`   | `timestamptz`        | Timestamp of kudo creation.                 |

### 16. `weekly_awards`
Stores the "Employee of the Week" awards.

| Column             | Type                 | Description                                  |
| ------------------ | -------------------- | -------------------------------------------- |
| `id`               | `uuid` (Primary Key) | Unique identifier for the award.             |
| `awarded_user_id`  | `uuid`               | Foreign key to `users.id` (receiver).        |
| `awarded_by_user_id`| `uuid`              | Foreign key to `users.id` (giver).           |
| `reason`           | `text`               | The reason for giving the award.             |
| `week_of`          | `date`               | The start date of the week for the award.    |

### 17. `payslips`
Stores metadata for employee payslips.

| Column         | Type                 | Description                               |
| -------------- | -------------------- | ----------------------------------------- |
| `id`           | `uuid` (Primary Key) | Unique identifier for the payslip.        |
| `user_id`      | `uuid`               | Foreign key to `users.id`.                |
| `month`        | `text`               | The month of the payslip (e.g., "July").  |
| `year`         | `integer`            | The year of the payslip.                  |
| `gross_salary` | `numeric`            | The gross salary amount.                  |
| `net_salary`   | `numeric`            | The net (take-home) salary amount.        |
| `download_url` | `text`               | A URL to download the payslip PDF.        |

### 18. `company_documents`
Stores links to company-wide documents and policies.

| Column        | Type                 | Description                                  |
| ------------- | -------------------- | -------------------------------------------- |
| `id`          | `uuid` (Primary Key) | Unique identifier for the document.          |
| `title`       | `text`               | The title of the document.                   |
| `description` | `text`               | A brief description of the document.         |
| `category`    | `text`               | Category like "HR", "IT", "Finance".         |
| `last_updated`| `date`               | The date the document was last updated.      |
| `download_url`| `text`               | A URL to download the document.              |

### 19. `expense_reports`
Stores employee expense reports.

| Column         | Type                 | Description                                       |
| -------------- | -------------------- | ------------------------------------------------- |
| `id`           | `uuid` (Primary Key) | Unique identifier for the report.                 |
| `user_id`      | `uuid`               | Foreign key to `users.id`.                        |
| `title`        | `text`               | The title of the expense report.                  |
| `total_amount` | `numeric`            | The total amount being claimed.                   |
| `status`       | `text`               | `draft`, `submitted`, `approved`, `rejected`, `reimbursed`. |
| `submitted_at` | `timestamptz`        | The timestamp when the report was submitted.      |

### 20. `expense_items`
Stores individual line items for an expense report.

| Column              | Type                 | Description                                    |
| ------------------- | -------------------- | ---------------------------------------------- |
| `id`                | `uuid` (Primary Key) | Unique identifier for the item.                |
| `expense_report_id` | `uuid`               | Foreign key to `expense_reports.id`.           |
| `date`              | `date`               | The date the expense was incurred.             |
| `category`          | `text`               | Category like "Travel", "Meals", "Software".   |
| `amount`            | `numeric`            | The amount of the individual expense.          |
| `description`       | `text`               | A description of the expense item.             |

### 21. `helpdesk_tickets`
Stores support tickets raised by employees.

| Column       | Type                 | Description                                |
| ------------ | -------------------- | ------------------------------------------ |
| `id`         | `uuid` (Primary Key) | Unique identifier for the ticket.          |
| `user_id`    | `uuid`               | Foreign key to `users.id` (creator).       |
| `subject`    | `text`               | The subject/title of the ticket.           |
| `description`| `text`               | A detailed description of the issue.       |
| `category`   | `text`               | `IT`, `HR`, `Finance`, `General`.          |
| `status`     | `text`               | `Open`, `In Progress`, `Resolved`, `Closed`. |
| `priority`   | `text`               | `Low`, `Medium`, `High`, `Urgent`.         |
| `created_at` | `timestamptz`        | Timestamp of ticket creation.              |
| `updated_at` | `timestamptz`        | Timestamp of the last update.              |
| `resolver_id`| `uuid`               | Foreign key to `users.id` (resolver).      |

### 22. `ticket_comments`
Stores comments on a helpdesk ticket.

| Column       | Type                 | Description                                 |
| ------------ | -------------------- | ------------------------------------------- |
| `id`         | `uuid` (Primary Key) | Unique identifier for the comment.          |
| `ticket_id`  | `uuid`               | Foreign key to `helpdesk_tickets.id`.       |
| `user_id`    | `uuid`               | Foreign key to `users.id` (author).         |
| `comment`    | `text`               | The content of the comment.                 |
| `created_at` | `timestamptz`        | Timestamp of comment creation.              |
